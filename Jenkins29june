node{ 
    def mavenHome = tool name: "maven3.6.3"
    properties([buildDiscarder(logRotator(artifactDaysToKeepStr: '', artifactNumToKeepStr: '', daysToKeepStr: '1', numToKeepStr: '4')), [$class: 'JobLocalConfiguration', changeReasonComment: ''], pipelineTriggers([pollSCM('* * * * *')])])
stage('checkout'){
   git branch: 'development', credentialsId: '360ea535-62b5-4e96-956e-dbe9d37aa313', url: 'https://github.com/mntechnologies-wallmart/maven-web-application.git' 
} 
stage('Build'){
    sh "$mavenHome/bin/mvn clean package"
}
stage('SonarQubeReport'){
    sh "$mavenHome/bin/mvn sonar:sonar"
}
stage('NexusRepo'){
    sh "$mavenHome/bin/mvn deploy"
}
stage('DeployIntoTomcat'){
    sshagent(['8265dfcc-fd10-4f66-8c4c-40197d148c72']) {
    sh "scp -o StrictHostKeyChecking=no target/maven-web-application.war ec2-user@52.66.211.0:/opt/tomcat9/webapps"
}
}
}
